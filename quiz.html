<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Quiz</title><script>qlist = `
pres{ident}:term:vice:succ{essor}
{G{eorge} }Washington:1789-{17}97:{J{ohn} }Adams:{J{ohn} }Adams
{J{ohn} }Adams:1797-1801:{T{homas} }Jefferson:{T{homas} }Jefferson
{T{homas} }Jefferson:1801-{{18}0}9:{A{aron} }Burr|{G{eorge} }Clinton:{J{ames} }Madison
{J{ames} }Madison:1809-{18}17:{G{eorge} }Clinton|{E{lbridge} }Gerry:{J{ames} }Monroe
{J{ames} }Monroe:1817-1825:{D{aniel} }{D{.} }Tompkins:{J{ohn} }{Q{uincy} }Adams
{J{ohn} }{Q{uincy} }Adams:1825-{{18}2}9:{J{ohn} }{C{aldwell} }Calhoun:{A{ndrew} }Jackson
{A{ndrew} }Jackson:1829-{18}37:{J{ohn} }{C{aldwell} }Calhoun|{M{artin} }Van Buren:{M{artin} }Van Buren
{M{artin} }Van Buren:1837-{18}41:{R{ichard} }{M{entor} }Johnson:{W{illiam|m} }{H{enry} }Harrison
{W{illiam|m} }{H{enry} }Harrison:1841:{J{ohn} }Tyler:{J{ohn} }Tyler
{J{ohn} }Tyler:1841-{{18}4}5:[N|n]one{ (1841-5)}:{J{ames} }{K{nox} }Polk
{J{ames} }{K{nox} }Polk:1845-{{18}4}9:{G{eorge} }{M{ifflin} }Dallas:{Z{achary} }Taylor
{Z{achary} }Taylor:1849-{18}50:{M{illard} }Fillmore:{M{illard} }Fillmore
{M{illard} }Fillmore:1850-{{18}5}3:[N|n]one{ (1850-3)}:{F{ranklin} }Pierce
{F{ranklin} }Pierce:1853-{{18}5}7:{W{illiam|m} }{R{ufus} }{de Vane }King:{J{ames} }Buchanan
{J{ames} }Buchanan:1857-{18}61:{J{ohn} }{C{abell} }Breckinridge:{A{braham|be} }Lincoln
{A{braham|be} }Lincoln:1861-{{18}6}5:{H{annibal} }Hamlin|{A{ndrew} }Johnson:{A{ndrew} }Johnson
{A{ndrew} }Johnson:1865-{{18}6}9:[N|n]one{ (1865-9)}:{U{lysses} }{S{impson} }Grant
{U{lysses} }{S{impson} }Grant:1869-{18}77:{S{chuyler} }Colfax|{H{enry} }Wilson:{R{utherford} }{B{irchard} }Hayes
{R{utherford} }{B{irchard} }Hayes:1877-{18}81:{W{illiam|m} }{A{lmon} }Wheeler:{J{ames} }{A{bram} }Garfield
{J{ames} }{A{bram} }Garfield:1881:{C{hester} }{A{lan} }Arthur:{C{hester} }{A{lan} }Arthur
{C{hester} }{A{lan} }Arthur:1881-{{18}8}5:[N|n]one{ (1881-5)}:{G{rover} }Cleveland{ (1st term)}
{G{rover} }Cleveland{ (1st term)}:1885-{{18}8}9:{T{homas} }{A{ndrews} }Hendricks:{B{enjamin} }Harrison
{B{enjamin} }Harrison:1889-{18}93:{L{evi} }{P{arsons} }Morton:{G{rover} }Cleveland{ (2nd term)}
{G{rover} }Cleveland{ (2nd term)}:1893-{18}97:{A{dlai} }{E{wing} }Stevenson:{W{illiam|m} }McKinley
{W{illiam|m} }McKinley:1897-1901:{G{arret} }{A{ugustus} }Hobart|{T{heodore|eddy} }Roosevelt|TR:{T{heodore|eddy} }Roosevelt|TR
{T{heodore|eddy} }Roosevelt|TR:1901-{{19}0}9:{C{harles} }{W{arren} }Fairbanks:{W{illiam|m} }{H{oward} }Taft
{W{illiam|m} }{H{oward} }Taft:1909-{19}13:{J{ames} }{S{choolcraft} }Sherman:{W{oodrow} }Wilson
{W{oodrow} }Wilson:1913-{19}21:{T{homas} }{R{iley} }Marshall:{W{arren} }{G{amaliel} }Harding
{W{arren} }{G{amaliel} }Harding:1921-{{19}2}3:{C{alvin} }Coolidge:{C{alvin} }Coolidge
{C{alvin} }Coolidge:1923-{{19}2}9:{C{harles} }{G{ates} }Dawes:{H{erbert} }{C{lark} }Hoover
{H{erbert} }{C{lark} }Hoover:1929-{19}33:{C{harles} }Curtis:{F{ranklin} }{D{elano} }Roosevelt|FDR
{F{ranklin} }{D{elano} }Roosevelt|FDR:1933-{19}45:{J{ohn} }{N{ance} }Garner|{H{enry} }{A{gard} }Wallace|{H{arry} }{S }Truman:{H{arry} }{S }Truman
{H{arry} }{S }Truman:1945-{19}53:{A{lben} }{W{illiam} }Barkley:{D{wight} }{D{avid} }Eisenhower
{D{wight} }{D{avid} }Eisenhower:1953-{19}61:{R{ichard} }{M{ilhous} }Nixon:{J{ohn} }{F{itzgerald} }Kennedy|JFK
{J{ohn} }{F{itzgerald} }Kennedy|JFK:1961-{{19}6}3:{L{yndon} }{B{aines} }Johnson|LBJ:{L{yndon} }{B{aines} }Johnson|LBJ
{L{yndon} }{B{aines} }Johnson|LBJ:1963-{{19}6}9:{H{ubert} }{H{oratio} }Humphrey:{R{ichard} }{M{ilhous} }Nixon
{R{ichard} }{M{ilhous} }Nixon:1969-{19}74:{S{piro} }{T{heodore} }Agnew|{G{erald} }{R{udolph} }Ford:{G{erald} }{R{udolph} }Ford
{G{erald} }{R{udolph} }Ford:1974-{{19}7}7:{N{elson} }{A{ldrich} }Rockefeller:{J{ames} }{E{arl} }Carter{{,} J{unio}r}
{J{ames} }{E{arl} }Carter{{,} J{unio}r}:1977-{19}81:{W{alter} }{F{rederick} }Mondale:{R{onald} }{W{ilson} }Reagan
{R{onald} }{W{ilson} }Reagan:1981-{{19}8}9:{G{eorge} }{H{erbert} }{W{alker} }Bush:{G{eorge} }{H{erbert} }{W{alker} }Bush
{G{eorge} }{H{erbert} }{W{alker} }Bush:1989-{19}93:{J{ames} }{D{anforth|an} }Quayle:{W{illiam|m} }{J{efferson} }Clinton
{W{illiam|m} }{J{efferson} }Clinton:1993-2001:{A{lbert} }{A{rnold} }Gore{{,} J{unio}r}:{G{eorge} }{W{alker} }Bush{{,} J{unio}r}
{G{eorge} }{W{alker} }Bush{{,} J{unio}r}:2001-:{R{ichard} }{B{ruce} }Cheney:Obama
`

    function say(text){
        //document.write(text + " <br /> ");
        console.log(text);
    }

    function keyToIndex(map,key) {
        var i = 0; for (var k of map.keys()) { if (k === key) return i; i++ }
        return null;  // if the key is not found
    }

    function adaptRegexp(regexp) {
        return regexp.replace(/\{/g,'(').replace(/\}/g,')?');
    }

    class QuestionCloud {
        constructor(questionId, factMap) {
            this.questionId = questionId;
            this.factMap = factMap;
        }

        getUniquifier(prompt, target) {
            var u = this.questionId;
            u += ":" + (keyToIndex(this.factMap,prompt) + 1);
            u += "/" + this.factMap.size;
            u += ":" + (keyToIndex(this.factMap,target) + 1);
            u += "/" + this.factMap.size;
            return u;
        }

        prettify(input) {
            var stuff = input.replace(/{.*}/g,"");
            say(stuff);
            return stuff;
        }

        checkGuess(promptCategory, targetCategory, guess) {
            say(adaptRegexp(this.factMap.get(targetCategory)));
            var regex1 = new RegExp(adaptRegexp(this.factMap.get(targetCategory)));
            
            if (regex1.test(guess)) {
                say("guess " + guess + " for " + targetCategory + " of " + promptCategory + " " + this.factMap.get(promptCategory) + " is right! Desired answer was " + this.factMap.get(targetCategory) );
                return true;
            } else {
                say("guess " + guess + " for " + targetCategory + " of " + promptCategory + " " + this.factMap.get(promptCategory) + " is WRONG! Desired answer was " + this.factMap.get(targetCategory) );
                return false;
            }
        }
    }

    function loadQuestionsFromTextBlob(blob, qStack){
        var numColMap = new Map();
        for (var line of blob.split('\n') ) {
            var numCol = line.split(':').length;
            if (numCol > 1) {
                numColMap.set(numCol, (numColMap.get(numCol) || 0) + 1);
            }
        }
        if (numColMap.size > 1) {
            say("ERROR : text blob has an irregular number of columns");
            for (var key of numColMap.keys() ) {
                say(key + " " + numColMap.get(key));
            }
            return;
        }
        var lineCount = 0;
        var headerArray = new Array();
        for (var line of blob.split('\n') ) {
            var cellArray = line.split(':');
            if (lineCount == 1) {  // we are in the header by definition // this is a big chapuza, I should try to get rid of the first and last lines which are blank
                headerArray = cellArray;
            } else if (cellArray.length > 1) {
                var factMap = new Map();
                var columnIndex = 0;
                for (var cell of cellArray) {
                    // say( headerArray[columnIndex] + " ==> " + cell);
                    factMap.set(headerArray[columnIndex], cell);
                    columnIndex++;
                }
                qStack.push(new QuestionCloud(line, factMap));

            }
            lineCount++;
        }
        return;
    }

    window.onload = function() {
        var progressReadout = document.getElementById('progressReadout');
        var questionText = document.getElementById('questionText');
        var answerBox = document.getElementById('answerBox');
        var tryButton = document.getElementById('tryButton');
        var tryResult = document.getElementById('tryResult');
        var outcomeTable = document.getElementById('outcomeTable');

        var numTry = 0;
        var questionMapIndex = -1;
        var promptCat = "pres{ident}";
        //var targetCat = "term";
        var targetCat = "succ{essor}";
        var qStack = new Array();
        var outcomeMap = new Map();
        var quizTitle = promptCat + " ==> " + targetCat;
        loadQuestionsFromTextBlob(qlist,qStack);

        tryButton.addEventListener('click', checkAnswer);
        answerBox.addEventListener('keyup', function(event) { if(event.keyCode === 13) checkAnswer(); });

        function nextQuestion() {
            numTry=0;
            questionMapIndex++;
            if (questionMapIndex >= qStack.length) {
                progressReadout.innerText = quizTitle + ' Done';
                questionMapIndex = 0;
                questionText.innerText="";
                answerBox.value = "";
                tryButton.value = "repeat quiz";
                tryResult.innerText = "";
                buildOutcomeTable(outcomeMap,qStack,outcomeTable);
            } else {
                progressReadout.innerText = quizTitle + ' [' + questionMapIndex.toString() + '/' + qStack.length.toString() + ']'; 
                i = 1;
                nextKey = qStack[questionMapIndex].factMap.get(promptCat);
                questionText.innerText = nextKey;
                answerBox.value = "";
                tryButton.value = "try";
                tryResult.innerText = "";
            }
        }

        function buildOutcomeTable(m,q,t) {
            for (var key of m.keys()) {
                var row = t.insertRow(-1);
                var cell1 = row.insertCell(0);
                var cell2 = row.insertCell(1);
                var cell3 = row.insertCell(2);
                cell1.innerHTML = key;
                cell2.innerHTML = "";  
                cell3.innerHTML = m.get(key); 
            }

            for (var element of q) {
                element.prettify(element.questionId);
            }

            console.dir(q);
            console.dir(m);
        }

        function destroyOutcomeTable(t) {
            while(t.hasChildNodes()) { t.removeChild(t.firstChild); }
        }

        function updateOutcomeMap(m,k,n) {
            if (m.has(k)) {
                m.set(k,outcomeMap.get(k) + n);
            } else {
                m.set(k, n);
            }
        }

        function checkAnswer() {
            numTry++;
            if ( tryButton.value === 'repeat quiz' ) {
                destroyOutcomeTable(outcomeTable);
                tryButton.value = "next question";
            }
            else if ( questionText.innerText === '' || tryButton.value === 'next question') {
                nextQuestion();
            } else {
                if (qStack[questionMapIndex].checkGuess(promptCat,targetCat,answerBox.value)){
                    tryResult.innerText = "Right!";
                    tryButton.value = "next question";
                    updateOutcomeMap(outcomeMap,qStack[questionMapIndex].getUniquifier(promptCat,targetCat),numTry);
                } else {
                    if (numTry < 3) {
                        tryResult.innerText = "What?";
                        tryButton.value = tryButton.value + ".";
                    }
                    else {
                        tryResult.innerText =  qStack[questionMapIndex].factMap.get(targetCat);
                        tryButton.value = "next question";
                        updateOutcomeMap(outcomeMap,qStack[questionMapIndex].getUniquifier(promptCat,targetCat),numTry);
                    }
                }
            }
        }
    }
  </script>

  <style>
        html {
            font-family: Helvetica, Arial, sans-serif;
            font-size: 100%;
            background: #333;
        }
    
        #page-wrapper {
            width: 600px;
            background: #FFF;
            padding: 1em;
            margin: 1em auto;
            min-height: 300px;
            border-top: 5px solid #69c773;
            box-shadow: 0 2px 10px rgba(0,0,0,0.8);
        }
    
        h1 {
            font-size: 220%;
            margin-top: 0;
        }

        h2 {
            font-size: 220%;
            margin-top: 5;
        }

        #tryButton {
            background-color:#69c773;
            color: white;
            border: none;
            padding: 15px 64px;
        }

      </style>
</head>

<body>
  <div id="page-wrapper">
    <h1>Quiz</h1>
    <div>
        <p id="progressReadout">[1/]</p> 
        <h2 id="questionText"></h2>
        <input type="text" id="answerBox" value="" autofocus>
        <input type="button" id="tryButton" value="start">
        <h2 id="tryResult"></h2> 
    </div>
    <div>
        <table id="outcomeTable"></table>
    </div>
  </div>
</body>

</html>
